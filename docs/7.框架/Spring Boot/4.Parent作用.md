# Spring-boot-starter-parent作用

## 一、核心作用概述

**spring-boot-starter-parent** 是 Spring Boot 项目的**推荐父POM**，它提供了 Maven 项目的**统一依赖管理**和**默认配置**。

```xml
<!-- 典型用法：项目继承 starter-parent -->
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.7.8</version>  <!-- 或 3.0.0+ -->
</parent>

<groupId>com.example</groupId>
<artifactId>my-spring-boot-app</artifactId>
<version>1.0.0</version>
```

## 二、六大核心功能

### 1. **统一依赖管理**（核心功能）
```xml
<!-- 查看 spring-boot-starter-parent 的父级：spring-boot-dependencies -->
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-dependencies</artifactId>
    <version>2.7.8</version>
</parent>

<!-- spring-boot-dependencies 中定义了 300+ 个依赖版本 -->
<properties>
    <!-- Spring 框架版本 -->
    <spring.version>5.3.23</spring.version>
    
    <!-- 数据库相关 -->
    <mysql.version>8.0.32</mysql.version>
    <postgresql.version>42.5.1</postgresql.version>
    <h2.version>2.1.214</h2.version>
    
    <!-- 工具库 -->
    <jackson.version>2.13.4</jackson.version>
    <slf4j.version>1.7.36</slf4j.version>
    <logback.version>1.2.11</logback.version>
    
    <!-- 内嵌容器 -->
    <tomcat.version>9.0.65</tomcat.version>
    <jetty.version>9.4.48.v20220622</jetty.version>
    
    <!-- 测试 -->
    <junit.version>5.8.2</junit.version>
    <mockito.version>4.5.1</mockito.version>
</properties>

<!-- 依赖管理部分 -->
<dependencyManagement>
    <dependencies>
        <!-- Spring Boot Starters -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
            <version>2.7.8</version>
        </dependency>
        
        <!-- 第三方库 -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>${mysql.version}</version>
        </dependency>
        
        <!-- ... 300+ 个依赖 -->
    </dependencies>
</dependencyManagement>
```

**效果**：子项目引用依赖时**无需指定版本**
```xml
<!-- 子项目直接使用，版本由 parent 管理 -->
<dependencies>
    <!-- 无需版本号！ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    
    <!-- 无需版本号！ -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
    </dependency>
</dependencies>
```

### 2. **默认插件配置**
```xml
<!-- parent 预配置了所有必要插件 -->
<build>
    <plugins>
        <!-- 1. 编译器插件 -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.10.1</version>
            <configuration>
                <!-- Java 版本（可覆盖） -->
                <source>1.8</source>
                <target>1.8</target>
                <encoding>UTF-8</encoding>
                <parameters>true</parameters> <!-- 保留参数名，用于反射 -->
            </configuration>
        </plugin>
        
        <!-- 2. Spring Boot Maven 插件 -->
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <version>2.7.8</version>
            <configuration>
                <mainClass>com.example.Application</mainClass>
                <layout>JAR</layout>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>repackage</goal> <!-- 构建可执行JAR -->
                    </goals>
                </execution>
            </executions>
        </plugin>
        
        <!-- 3. 资源处理插件 -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-resources-plugin</artifactId>
            <version>3.2.0</version>
            <configuration>
                <delimiters>
                    <delimiter>@</delimiter> <!-- 资源过滤分隔符 -->
                </delimiters>
                <useDefaultDelimiters>false</useDefaultDelimiters>
            </configuration>
        </plugin>
        
        <!-- 4. 打包插件 -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>3.2.2</version>
            <configuration>
                <archive>
                    <!-- 生成MANIFEST.MF -->
                    <manifest>
                        <addDefaultImplementationEntries>true</addDefaultImplementationEntries>
                        <addDefaultSpecificationEntries>true</addDefaultSpecificationEntries>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
    </plugins>
</build>
```

### 3. **资源过滤配置**
```xml
<build>
    <resources>
        <resource>
            <directory>${basedir}/src/main/resources</directory>
            <filtering>true</filtering> <!-- 启用资源过滤 -->
            <includes>
                <include>**/application*.yml</include>
                <include>**/application*.yaml</include>
                <include>**/application*.properties</include>
            </includes>
        </resource>
        <resource>
            <directory>${basedir}/src/main/resources</directory>
            <filtering>false</filtering>
            <excludes>
                <exclude>**/application*.yml</exclude>
                <exclude>**/application*.yaml</exclude>
                <exclude>**/application*.properties</exclude>
            </excludes>
        </resource>
    </resources>
</build>
```

**作用**：支持配置文件中的 Maven 属性替换
```properties
# application.properties
app.name=@project.artifactId@
app.version=@project.version@
app.description=@project.description@

# 构建时会被替换为：
# app.name=my-spring-boot-app
# app.version=1.0.0
```

### 4. **默认属性配置**
```xml
<properties>
    <!-- 项目基础信息 -->
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    
    <!-- Java版本（Spring Boot 2.x默认1.8，3.x默认17） -->
    <java.version>1.8</java.version>
    
    <!-- 资源过滤分隔符 -->
    <resource.delimiter>@</resource.delimiter>
    
    <!-- Maven插件版本 -->
    <maven.compiler.source>${java.version}</maven.compiler.source>
    <maven.compiler.target>${java.version}</maven.compiler.target>
    
    <!-- 测试配置 -->
    <maven.test.skip>false</maven.test.skip>
    <maven.test.failure.ignore>false</maven.test.failure.ignore>
</properties>
```

### 5. **Profile 配置**
```xml
<profiles>
    <!-- 开发环境Profile -->
    <profile>
        <id>dev</id>
        <properties>
            <activatedProperties>dev</activatedProperties>
        </properties>
        <activation>
            <activeByDefault>true</activeByDefault> <!-- 默认激活 -->
        </activation>
    </profile>
    
    <!-- 生产环境Profile -->
    <profile>
        <id>prod</id>
        <properties>
            <activatedProperties>prod</activatedProperties>
        </properties>
    </profile>
</profiles>
```

### 6. **测试配置**
```xml
<!-- 默认测试依赖配置 -->
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <version>2.7.8</version>
            <scope>test</scope>
            <exclusions>
                <exclusion>
                    <groupId>org.junit.vintage</groupId>
                    <artifactId>junit-vintage-engine</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
    </dependencies>
</dependencyManagement>

<!-- 测试资源过滤 -->
<testResources>
    <testResource>
        <directory>${basedir}/src/test/resources</directory>
        <filtering>true</filtering>
    </testResource>
</testResources>
```

## 三、使用方式对比

### 方式1：继承 starter-parent（推荐）
```xml
<!-- pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    
    <!-- 继承 Spring Boot Parent -->
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.7.8</version>
    </parent>
    
    <groupId>com.example</groupId>
    <artifactId>myapp</artifactId>
    <version>1.0.0</version>
    
    <properties>
        <!-- 可覆盖父POM属性 -->
        <java.version>11</java.version>
    </properties>
    
    <dependencies>
        <!-- 依赖无需版本 -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
    </dependencies>
</project>
```

### 方式2：不继承，使用 dependencyManagement
```xml
<!-- pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    
    <groupId>com.example</groupId>
    <artifactId>myapp</artifactId>
    <version>1.0.0</version>
    
    <!-- 引入依赖管理 -->
    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-dependencies</artifactId>
                <version>2.7.8</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
        </dependencies>
    </dependencyManagement>
    
    <dependencies>
        <!-- 依赖无需版本 -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
    </dependencies>
    
    <!-- 需要手动配置插件 -->
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>2.7.8</version>
            </plugin>
        </plugins>
    </build>
</project>
```

## 四、自定义配置与覆盖

### 1. **覆盖 Java 版本**
```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.7.8</version>
</parent>

<properties>
    <!-- 覆盖默认的Java版本 -->
    <java.version>11</java.version>  <!-- 或 17 -->
</properties>
```

### 2. **覆盖依赖版本**
```xml
<properties>
    <!-- 覆盖特定依赖版本 -->
    <mysql.version>8.0.33</mysql.version>
    <jackson.version>2.14.0</jackson.version>
</properties>

<dependencies>
    <!-- 使用新版本 -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <!-- 版本由上面属性控制 -->
    </dependency>
</dependencies>
```

### 3. **添加自定义插件**
```xml
<build>
    <plugins>
        <!-- 继承父POM的所有插件 -->
        
        <!-- 添加自定义插件 -->
        <plugin>
            <groupId>com.github.spotbugs</groupId>
            <artifactId>spotbugs-maven-plugin</artifactId>
            <version>4.7.0.0</version>
        </plugin>
        
        <!-- 覆盖父POM插件配置 -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <!-- 覆盖编译器参数 -->
                <source>11</source>
                <target>11</target>
                <compilerArgs>
                    <arg>-parameters</arg>
                </compilerArgs>
            </configuration>
        </plugin>
    </plugins>
</build>
```

### 4. **配置资源过滤**
```xml
<build>
    <resources>
        <resource>
            <directory>src/main/resources</directory>
            <filtering>true</filtering>
            <includes>
                <include>**/*.properties</include>
                <include>**/*.yml</include>
            </includes>
        </resource>
    </resources>
    
    <!-- 自定义过滤属性 -->
    <filters>
        <filter>src/main/filters/dev.properties</filter>
    </filters>
</build>
```

## 五、实际应用场景

### 场景1：多模块项目
```xml
<!-- 父模块 pom.xml -->
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.7.8</version>
</parent>

<groupId>com.example</groupId>
<artifactId>myproject-parent</artifactId>
<version>1.0.0</version>
<packaging>pom</packaging>

<modules>
    <module>common</module>
    <module>service-api</module>
    <module>service-impl</module>
    <module>web-app</module>
</modules>

<!-- 子模块继承此父模块，而非直接继承 spring-boot-starter-parent -->
```

### 场景2：企业级项目配置
```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.7.8</version>
</parent>

<properties>
    <!-- 企业统一配置 -->
    <java.version>11</java.version>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    
    <!-- 企业私有仓库 -->
    <nexus.url>http://nexus.internal.com/repository/maven-public/</nexus.url>
</properties>

<repositories>
    <repository>
        <id>nexus</id>
        <url>${nexus.url}</url>
        <releases>
            <enabled>true</enabled>
        </releases>
        <snapshots>
            <enabled>true</enabled>
        </snapshots>
    </repository>
</repositories>
```

## 六、Spring Boot 2.x 与 3.x 区别

### Spring Boot 2.x
```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.7.8</version>  <!-- 最后一个2.x版本 -->
</parent>

<properties>
    <!-- 默认Java 1.8 -->
    <java.version>1.8</java.version>
</properties>
```

### Spring Boot 3.x
```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>3.0.0</version>  <!-- 需要Java 17+ -->
</parent>

<properties>
    <!-- 默认Java 17，必须>=17 -->
    <java.version>17</java.version>
    
    <!-- Jakarta EE 9+ (javax -> jakarta) -->
    <jakarta-servlet.version>6.0.0</jakarta-servlet.version>
</properties>
```

## 七、常见问题与解决方案

### 问题1：版本冲突
```xml
<!-- 解决方案：排除或覆盖 -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
    <exclusions>
        <exclusion>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-tomcat</artifactId>
        </exclusion>
    </exclusions>
</dependency>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-jetty</artifactId>
</dependency>
```

### 问题2：无法继承自定义父POM
```xml
<!-- 解决方案1：使用 dependencyManagement -->
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>2.7.8</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>

<!-- 解决方案2：多层继承 -->
<parent>
    <groupId>com.company</groupId>
    <artifactId>company-parent</artifactId>  <!-- 公司父POM -->
    <version>1.0.0</version>
</parent>

<!-- 公司父POM再继承spring-boot-starter-parent -->
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.7.8</version>
</parent>
```

### 问题3：插件配置冲突
```xml
<!-- 解决方案：明确声明插件，覆盖父配置 -->
<build>
    <plugins>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <configuration>
                <excludes>
                    <exclude>
                        <groupId>org.projectlombok</groupId>
                        <artifactId>lombok</artifactId>
                    </exclude>
                </excludes>
            </configuration>
        </plugin>
    </plugins>
</build>
```

## 八、最佳实践总结

### 应该使用 starter-parent 的场景：
1. **新项目**：快速启动，减少配置
2. **微服务**：统一技术栈和版本
3. **原型/演示项目**：快速开发验证
4. **独立应用**：不需要复杂Maven继承

### 不应该使用 starter-parent 的场景：
1. **已有复杂父POM**：公司已有统一的父POM
2. **需要细粒度控制**：需要完全控制Maven配置
3. **非Spring Boot项目**：纯Spring或其他框架项目

### 替代方案：
```xml
<!-- 1. 只使用依赖管理 -->
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>2.7.8</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>

<!-- 2. 自定义父POM继承starter-parent -->
<!-- 3. 使用BOM文件管理依赖 -->
```

## 总结

**spring-boot-starter-parent** 的核心价值：

1. **依赖管理**：统一管理 300+ 依赖版本，避免冲突
2. **默认配置**：预配置编译器、打包、资源过滤等
3. **开箱即用**：快速启动 Spring Boot 项目
4. **最佳实践**：内置 Spring Boot 推荐配置
5. **简化维护**：版本升级只需修改 parent 版本

**一句话总结**：**spring-boot-starter-parent 是 Spring Boot 项目的"一站式"配置中心，通过合理的默认配置和依赖管理，让开发者专注于业务代码，而不是构建配置。**