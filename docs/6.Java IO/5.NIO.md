# NIO

## **1. NIO 概述与核心思想**

### **1.1 什么是NIO？**

NIO（New Input/Output，Non-blocking I/O）是JDK 1.4引入的新IO API，提供了一种**非阻塞、可伸缩的IO操作方式**。

NIO的核心设计目标是：

- **更高的性能**：减少系统调用，使用内存映射
- **更好的扩展性**：单线程处理多个连接
- **更灵活的IO操作**：非阻塞模式、选择器机制

### **1.2 传统IO vs NIO**

| 特性         | 传统IO (java.io)    | NIO (java.nio)     |
| :----------- | :------------------ | :----------------- |
| **数据流**   | 面向流(Stream)      | 面向缓冲区(Buffer) |
| **阻塞性**   | 阻塞IO              | 支持非阻塞IO       |
| **方向**     | 单向(输入/输出分开) | 双向(通道可读写)   |
| **选择器**   | 不支持              | 支持(Selector)     |
| **适用场景** | 连接数较少          | 高并发连接         |

## **2. NIO 三大核心组件**

### **2.1 缓冲区(Buffer)**

#### **Buffer 的层次结构**

```java
// Buffer继承体系
Buffer (抽象类)
├── ByteBuffer (最常用)
│   ├── HeapByteBuffer (堆内存)
│   ├── DirectByteBuffer (直接内存)
│   └── MappedByteBuffer (内存映射)
├── CharBuffer
├── ShortBuffer
├── IntBuffer
├── LongBuffer
├── FloatBuffer
└── DoubleBuffer
```

### **2.2 通道(Channel)**

#### Channel 继承体系

```java
// Channel主要类型
Channel (接口)
├── ReadableByteChannel
├── WritableByteChannel
├── ByteChannel (组合ReadableByteChannel和WritableByteChannel)
├── FileChannel (文件操作)
├── SocketChannel (TCP客户端)
├── ServerSocketChannel (TCP服务器)
├── DatagramChannel (UDP)
└── SelectableChannel (可注册到Selector)
```

