# 编码

## 编码与解码

编码就是把字符(`char`)转换为字节(`byte`)，解码是把字节(`byte`)重新组合成字符(`char`)。

如果编码和解码过程使用不同的编码方式那么就出现了乱码。

- GBK 编码中，中文字符占 2 个字节，英文字符占 1 个字节；
- UTF-8 编码中，中文字符占 3 个字节，英文字符占 1 个字节；
- UTF-16be 编码中，中文字符和英文字符都占 2 个字节。
  - UTF-16be 中的 be 指的是 Big Endian，也就是大端。
- UTF-16le，le 指的是 Little Endian，也就是小端。

##  Java 编码

Java 的内存编码默认使用双字节编码 UTF-16be，即 `char` 这种类型使用 UTF-16be 进行编码。

`char` 类型占 16 位，即两个字节，Java 使用这种双字节编码是为了让一个中文或者一个英文都能使用一个 `char` 来存储。

## String 编码

`String` 可以看成一个字符序列，可以使用一种编码方法将字符序列进行编码和解码。

- 指定一个编码方式将字符序列编码为字节序列；
- 指定一个编码方式将字节序列解码为字符序列。

## Reader 与 Writer

不管是磁盘还是网络传输，最小的存储单元都是字节，而不是字符。

但是在程序中操作的通常是字符形式的数据，因此需要提供对字符进行操作的方法。

- `InputStreamReader` 实现从字节流 解码 成字符流（磁盘、网络->内存）
- `OutputStreamWriter` 实现字符流 编码 为字节流（内存->磁盘、网络）

## 示例

**字符流体系（解决编码问题）**

```java
// 使用指定编码读取文件
try (BufferedReader reader = new BufferedReader(
        new InputStreamReader(
            new FileInputStream("file.txt"), 
            StandardCharsets.UTF_8))) {
    
    String line;
    while ((line = reader.readLine()) != null) {
        // 处理每一行
    }
}
```

**字符编码处理（JDK8 增强）：**

```java
// Java 8 新增的快捷方法
List<String> lines = Files.readAllLines(Paths.get("file.txt"), 
                                        StandardCharsets.UTF_8);

// 直接读取为字符串
String content = new String(Files.readAllBytes(path), 
                           StandardCharsets.ISO_8859_1);
```